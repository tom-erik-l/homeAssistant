# Wake up light stuff
# see: https://www.wouterbulten.nl/blog/tech/custom-wake-up-light-with-home-assistant/
input_boolean:
  wakeup_enabled:
    name: "Wake-up lights"
    #initial: on
    icon: mdi:theme-light-dark
  wakeup_weekend:
    name: "Enable Wake-up on weekends"
    #initial: off # I disable the system on default on weekends
    icon: mdi:calendar-blank
  wakeup_test:
    name: "Test Wake-up"
    #initial: off # I disable the system on default on weekends
    icon: mdi:calendar-blank

input_datetime:
  wakeup_time:
    name: "Start lights at"
    has_time: true
    has_date: false

automation:
  - alias: "Wake-me up using bedroom lights"
    trigger:
      platform: template
      value_template: "{{ states('sensor.time') == (states.input_datetime.wakeup_time.attributes.timestamp | int | timestamp_custom('%H:%M', False)) }}"
    condition:
      - condition: state
        entity_id: input_boolean.wakeup_enabled
        state: 'on'
      - condition: or # One of the conditions below must be true
        conditions:
          - condition: state # Will be true when the switch is 'on'
            entity_id: input_boolean.wakeup_weekend
            state: 'on'
          - condition: time # Will be true on weekdays
            weekday:
              - mon
              - tue
              - wed
              - thu
              - fri
          - condition: state
            entity_id: input_boolean.wakeup_test
            state: 'on'
    action:
    - service: light.turn_on
      entity_id: light.stue_lys
      data:
        transition: 600 # Transition time in seconds
        brightness: 255
